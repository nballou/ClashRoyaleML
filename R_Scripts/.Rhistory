calc_avg_elixir <- function() {
data$left_elixir_cost <- 0
data$right_elixir_cost <- 0
for (i in 1:74) {
card_name_L <- paste("^", all_cards[i], "_L", "$", sep = "")
card_name_R <- paste("^", all_cards[i], "_R", "$", sep = "")
col_index_L <- grep(card_name_L, colnames(data))[1]
col_index_R <- grep(card_name_R, colnames(data))[1]
print(c(card_name_L,col_index_L))
if (data[,col_index_L] == 1) {
data$left_elixir_cost[col_index_L] <- data$left_elixir_cost[col_index_L]+costs[i]
}
if (data[col_index_R] == 1) {
data$right_elixir_cost <- data$right_elixir_cost+costs[i]
}
# print(c(i,data$left_elixir_cost[i],data$right_elixir_cost[i]))
}
return(c(data$left_elixir_cost,data$right_elixir_cost))
}
calc_avg_elixir()
calc_avg_elixir <- function() {
data$left_elixir_cost <- 0
data$right_elixir_cost <- 0
for (i in 1:74) {
card_name_L <- paste("^", all_cards[i], "_L", "$", sep = "")
card_name_R <- paste("^", all_cards[i], "_R", "$", sep = "")
col_index_L <- grep(card_name_L, colnames(data))[1]
col_index_R <- grep(card_name_R, colnames(data))[1]
print(c(card_name_L,col_index_L))
ifelse(data[,col_index_L ==1],data$left_elixir_cost <- data$left_elixir_cost+costs[i], data$left_elixir_cost)
}
#   if (data[,col_index_L] == 1) {
#     data$left_elixir_cost[col_index_L] <- data$left_elixir_cost[col_index_L]+costs[i]
#   }
#   if (data[col_index_R] == 1) {
#     data$right_elixir_cost <- data$right_elixir_cost+costs[i]
#   }
#   # print(c(i,data$left_elixir_cost[i],data$right_elixir_cost[i]))
# }
return(c(data$left_elixir_cost,data$right_elixir_cost))
}
calc_avg_elixir()
calc_avg_elixir <- function() {
data$left_elixir_cost <- 0
data$right_elixir_cost <- 0
for (i in 1:74) {
card_name_L <- paste("^", all_cards[i], "_L", "$", sep = "")
card_name_R <- paste("^", all_cards[i], "_R", "$", sep = "")
col_index_L <- grep(card_name_L, colnames(data))[1]
col_index_R <- grep(card_name_R, colnames(data))[1]
print(c(card_name_L,col_index_L))
ifelse(data[,col_index_L ==1],data$left_elixir_cost <- data$left_elixir_cost+costs[i], data$left_elixir_cost)
}
#   if (data[,col_index_L] == 1) {
#     data$left_elixir_cost[col_index_L] <- data$left_elixir_cost[col_index_L]+costs[i]
#   }
#   if (data[col_index_R] == 1) {
#     data$right_elixir_cost <- data$right_elixir_cost+costs[i]
#   }
#   # print(c(i,data$left_elixir_cost[i],data$right_elixir_cost[i]))
# }
return(c(data$left_elixir_cost,data$right_elixir_cost))
}
calc_avg_elixir()
calc_avg_elixir <- function() {
data$left_elixir_cost <- 0
data$right_elixir_cost <- 0
for (i in 1:74) {
card_name_L <- paste("^", all_cards[i], "_L", "$", sep = "")
card_name_R <- paste("^", all_cards[i], "_R", "$", sep = "")
col_index_L <- grep(card_name_L, colnames(data))[1]
col_index_R <- grep(card_name_R, colnames(data))[1]
print(c(card_name_L,col_index_L))
if (data[,col_index_L] == 1) {
data$left_elixir_cost <- data$left_elixir_cost+costs[i]
}
if (data[col_index_R] == 1) {
data$right_elixir_cost <- data$right_elixir_cost+costs[i]
}
# print(c(i,data$left_elixir_cost[i],data$right_elixir_cost[i]))
}
# return(c(data$left_elixir_cost,data$right_elixir_cost))
}
calc_avg_elixir()
costs[1]
costs[6]
costs[56]
calc_avg_elixir <- function() {
data$left_elixir_cost <- 0
data$right_elixir_cost <- 0
for (i in 1:74) {
card_name_L <- paste("^", all_cards[i], "_L", "$", sep = "")
card_name_R <- paste("^", all_cards[i], "_R", "$", sep = "")
col_index_L <- grep(card_name_L, colnames(data))[1]
col_index_R <- grep(card_name_R, colnames(data))[1]
print(c(card_name_L,col_index_L))
if (data[,col_index_L] == 1) {
data$left_elixir_cost <- data$left_elixir_cost+costs[i]
}
if (data[,col_index_R] == 1) {
data$right_elixir_cost <- data$right_elixir_cost+costs[i]
}
# print(c(i,data$left_elixir_cost[i],data$right_elixir_cost[i]))
}
# return(c(data$left_elixir_cost,data$right_elixir_cost))
}
calc_avg_elixir()
warnings()
calc_avg_elixir <- function() {
data$left_elixir_cost <- 0
data$right_elixir_cost <- 0
for (i in 1:74) {
card_name_L <- paste("^", all_cards[i], "_L", "$", sep = "")
card_name_R <- paste("^", all_cards[i], "_R", "$", sep = "")
col_index_L <- grep(card_name_L, colnames(data))[1]
col_index_R <- grep(card_name_R, colnames(data))[1]
print(c(card_name_L,col_index_L))
if (data[col_index_L,] == 1) {
data$left_elixir_cost <- data$left_elixir_cost+costs[i]
}
if (data[col_index_R,] == 1) {
data$right_elixir_cost <- data$right_elixir_cost+costs[i]
}
# print(c(i,data$left_elixir_cost[i],data$right_elixir_cost[i]))
}
# return(c(data$left_elixir_cost,data$right_elixir_cost))
}
calc_avg_elixir()
warnings()
costs[5]
calc_avg_elixir <- function() {
data$left_elixir_cost <- 0
data$right_elixir_cost <- 0
for (i in 1:74) {
card_name_L <- paste("^", all_cards[i], "_L", "$", sep = "")
card_name_R <- paste("^", all_cards[i], "_R", "$", sep = "")
col_index_L <- grep(card_name_L, colnames(data))[1]
col_index_R <- grep(card_name_R, colnames(data))[1]
print(c(card_name_L,col_index_L))
for (row in 1:nrow(data)) {
if (data[row,col_index_L] == 1) {
data[row,left_elixir_cost] <- data[row,left_elixir_cost]+costs[i]
}
if (data[row,col_index_R] == 1) {
data[row,right_elixir_cost] <- data[row,right_elixir_cost]+costs[i]
}
# if (data[col_index_L,] == 1) {
#   data$left_elixir_cost <- data$left_elixir_cost+costs[i]
# }
# if (data[col_index_R,] == 1) {
#   data$right_elixir_cost <- data$right_elixir_cost+costs[i]
# }
# print(c(i,data$left_elixir_cost[i],data$right_elixir_cost[i]))
}
# return(c(data$left_elixir_cost,data$right_elixir_cost))
}
calc_avg_elixir()
calc_avg_elixir <- function() {
data$left_elixir_cost <- 0
data$right_elixir_cost <- 0
for (i in 1:74) {
card_name_L <- paste("^", all_cards[i], "_L", "$", sep = "")
card_name_R <- paste("^", all_cards[i], "_R", "$", sep = "")
col_index_L <- grep(card_name_L, colnames(data))[1]
col_index_R <- grep(card_name_R, colnames(data))[1]
print(c(card_name_L,col_index_L))
for (row in 1:nrow(data)) {
if (data[row,col_index_L] == 1) {
data[row,left_elixir_cost] <- data[row,left_elixir_cost]+costs[i]
}
if (data[row,col_index_R] == 1) {
data[row,327] <- data[row,328]+costs[i]
}
# if (data[col_index_L,] == 1) {
#   data$left_elixir_cost <- data$left_elixir_cost+costs[i]
# }
# if (data[col_index_R,] == 1) {
#   data$right_elixir_cost <- data$right_elixir_cost+costs[i]
# }
# print(c(i,data$left_elixir_cost[i],data$right_elixir_cost[i]))
}
# return(c(data$left_elixir_cost,data$right_elixir_cost))
}
calc_avg_elixir()
data[,327]
calc_avg_elixir <- function() {
data$left_elixir_cost <- 0
data$right_elixir_cost <- 0
for (i in 1:74) {
card_name_L <- paste("^", all_cards[i], "_L", "$", sep = "")
card_name_R <- paste("^", all_cards[i], "_R", "$", sep = "")
col_index_L <- grep(card_name_L, colnames(data))[1]
col_index_R <- grep(card_name_R, colnames(data))[1]
print(c(card_name_L,col_index_L))
for (row in 1:nrow(data)) {
if (data[row,col_index_L] == 1) {
data[row,327] <- data[row,327]+costs[i]
}
if (data[row,col_index_R] == 1) {
data[row,328] <- data[row,328]+costs[i]
}
# if (data[col_index_L,] == 1) {
#   data$left_elixir_cost <- data$left_elixir_cost+costs[i]
# }
# if (data[col_index_R,] == 1) {
#   data$right_elixir_cost <- data$right_elixir_cost+costs[i]
# }
# print(c(i,data$left_elixir_cost[i],data$right_elixir_cost[i]))
}
# return(c(data$left_elixir_cost,data$right_elixir_cost))
}
calc_avg_elixir()
data[65,]
calc_avg_elixir <- function() {
data$left_elixir_cost <- 0
data$right_elixir_cost <- 0
for (i in 1:74) {
card_name_L <- paste("^", all_cards[i], "_L", "$", sep = "")
card_name_R <- paste("^", all_cards[i], "_R", "$", sep = "")
col_index_L <- grep(card_name_L, colnames(data))[1]
col_index_R <- grep(card_name_R, colnames(data))[1]
print(c(card_name_L,col_index_L))
if (data[,col_index_L] == 1) {
data$left_elixir_cost <- data$left_elixir_cost+costs[i]
}
if (data[col_index_R,] == 1) {
data$right_elixir_cost <- data$right_elixir_cost+costs[i]
}
print(c(i,data$left_elixir_cost[i],data$right_elixir_cost[i]))
}
calc_avg_elixir()
warnings()
calc_avg_elixir <- function() {
data$left_elixir_cost <- 0
data$right_elixir_cost <- 0
for (i in 1:74) {
card_name_L <- paste("^", all_cards[i], "_L", "$", sep = "")
card_name_R <- paste("^", all_cards[i], "_R", "$", sep = "")
col_index_L <- grep(card_name_L, colnames(data))[1]
col_index_R <- grep(card_name_R, colnames(data))[1]
print(c(card_name_L,col_index_L))
if (data[,col_index_L] == 1) {
data$left_elixir_cost <- data$left_elixir_cost+costs[i]
}
if (data[,col_index_R] == 1) {
data$right_elixir_cost <- data$right_elixir_cost+costs[i]
}
print(c(i,data$left_elixir_cost[i],data$right_elixir_cost[i]))
}
calc_avg_elixir()
warnings()
calc_avg_elixir <- function() {
data$left_elixir_cost <- 0
data$right_elixir_cost <- 0
for (i in 1:74) {
card_name_L <- paste("^", all_cards[i], "_L", "$", sep = "")
card_name_R <- paste("^", all_cards[i], "_R", "$", sep = "")
col_index_L <- grep(card_name_L, colnames(data))[1]
col_index_R <- grep(card_name_R, colnames(data))[1]
print(c(card_name_L,col_index_L))
ifelse(data[,col_index_L == 1], data[,327]+costs[i],data[,327])
ifelse(data[,col_index_R == 1], data[,328]+costs[i],data[,328])
# if (data[,col_index_L] == 1) {
#   data$left_elixir_cost <- data$left_elixir_cost+costs[i]
# }
# if (data[,col_index_R] == 1) {
#   data$right_elixir_cost <- data$right_elixir_cost+costs[i]
# }
print(c(i,data$left_elixir_cost[i],data$right_elixir_cost[i]))
}
calc_avg_elixir()
calc_avg_elixir <- function() {
data$left_elixir_cost <- 0
data$right_elixir_cost <- 0
for (i in 1:74) {
card_name_L <- paste("^", all_cards[i], "_L", "$", sep = "")
card_name_R <- paste("^", all_cards[i], "_R", "$", sep = "")
col_index_L <- grep(card_name_L, colnames(data))[1]
col_index_R <- grep(card_name_R, colnames(data))[1]
print(c(card_name_L,col_index_L))
ifelse(data[,col_index_L == 1], data$left_elixir_cost+costs[i],data$left_elixir_cost)
ifelse(data[,col_index_R == 1], data$left_elixir_cost+costs[i],data$left_elixir_cost)
# if (data[,col_index_L] == 1) {
#   data$left_elixir_cost <- data$left_elixir_cost+costs[i]
# }
# if (data[,col_index_R] == 1) {
#   data$right_elixir_cost <- data$right_elixir_cost+costs[i]
# }
print(c(i,data$left_elixir_cost[i],data$right_elixir_cost[i]))
}
calc_avg_elixir()
calc_avg_elixir <- function() {
data$left_elixir_cost <- 0
data$right_elixir_cost <- 0
for (i in 1:74) {
card_name_L <- paste("^", all_cards[i], "_L", "$", sep = "")
card_name_R <- paste("^", all_cards[i], "_R", "$", sep = "")
col_index_L <- grep(card_name_L, colnames(data))[1]
col_index_R <- grep(card_name_R, colnames(data))[1]
print(c(card_name_L,col_index_L))
ifelse(data[,col_index_L == 1], data[,327]+costs[i],data[,327])
ifelse(data[,col_index_R == 1], data[,328]+costs[i],data[,328])
# if (data[,col_index_L] == 1) {
#   data$left_elixir_cost <- data$left_elixir_cost+costs[i]
# }
# if (data[,col_index_R] == 1) {
#   data$right_elixir_cost <- data$right_elixir_cost+costs[i]
# }
print(c(i,data$left_elixir_cost[i],data$right_elixir_cost[i]))
}
calc_avg_elixir()
calc_avg_elixir <- function() {
data$left_elixir_cost <- 0
data$right_elixir_cost <- 0
for (i in 1:74) {
card_name_L <- paste("^", all_cards[i], "_L", "$", sep = "")
card_name_R <- paste("^", all_cards[i], "_R", "$", sep = "")
col_index_L <- grep(card_name_L, colnames(data))[1]
col_index_R <- grep(card_name_R, colnames(data))[1]
print(c(card_name_L,col_index_L))
data$left_elixir_cost <- ifelse(data[,col_index_L == 1], data_left_elixir_cost+costs[i],data$left_elixir_cost)
data$right_elixir_cost <- ifelse(data[,col_index_R == 1], data_right_elixir_cost+costs[i],data$right_elixir_cost)
# if (data[,col_index_L] == 1) {
#   data$left_elixir_cost <- data$left_elixir_cost+costs[i]
# }
# if (data[,col_index_R] == 1) {
#   data$right_elixir_cost <- data$right_elixir_cost+costs[i]
# }
print(c(i,data$left_elixir_cost[i],data$right_elixir_cost[i]))
}
calc_avg_elixir()
calc_avg_elixir <- function() {
data$left_elixir_cost <- 0
data$right_elixir_cost <- 0
for (i in 1:74) {
card_name_L <- paste("^", all_cards[i], "_L", "$", sep = "")
card_name_R <- paste("^", all_cards[i], "_R", "$", sep = "")
col_index_L <- grep(card_name_L, colnames(data))[1]
col_index_R <- grep(card_name_R, colnames(data))[1]
print(c(card_name_L,col_index_L))
data$left_elixir_cost <- ifelse(data[,col_index_L] == 1, data_left_elixir_cost+costs[i],data$left_elixir_cost)
data$right_elixir_cost <- ifelse(data[,col_index_R] == 1, data_right_elixir_cost+costs[i],data$right_elixir_cost)
# if (data[,col_index_L] == 1) {
#   data$left_elixir_cost <- data$left_elixir_cost+costs[i]
# }
# if (data[,col_index_R] == 1) {
#   data$right_elixir_cost <- data$right_elixir_cost+costs[i]
# }
print(c(i,data$left_elixir_cost[i],data$right_elixir_cost[i]))
}
calc_avg_elixir()
calc_avg_elixir <- function() {
data$left_elixir_cost <- 0
data$right_elixir_cost <- 0
for (i in 1:74) {
card_name_L <- paste("^", all_cards[i], "_L", "$", sep = "")
card_name_R <- paste("^", all_cards[i], "_R", "$", sep = "")
col_index_L <- grep(card_name_L, colnames(data))[1]
col_index_R <- grep(card_name_R, colnames(data))[1]
print(c(card_name_L,col_index_L))
data$left_elixir_cost <- ifelse(data[,col_index_L] == 1, data$left_elixir_cost+costs[i],data$left_elixir_cost)
data$right_elixir_cost <- ifelse(data[,col_index_R] == 1, data$right_elixir_cost+costs[i],data$right_elixir_cost)
# if (data[,col_index_L] == 1) {
#   data$left_elixir_cost <- data$left_elixir_cost+costs[i]
# }
# if (data[,col_index_R] == 1) {
#   data$right_elixir_cost <- data$right_elixir_cost+costs[i]
# }
print(c(i,data$left_elixir_cost[i],data$right_elixir_cost[i]))
}
calc_avg_elixir()
View(data)
summary(data$left_elixir_cost)
calc_avg_elixir <- function() {
data$left_elixir_cost <- 0
data$right_elixir_cost <- 0
for (i in 1:74) {
card_name_L <- paste("^", all_cards[i], "_L", "$", sep = "")
card_name_R <- paste("^", all_cards[i], "_R", "$", sep = "")
col_index_L <- grep(card_name_L, colnames(data))[1]
col_index_R <- grep(card_name_R, colnames(data))[1]
print(c(card_name_L,col_index_L))
data$left_elixir_cost <- ifelse(data[,col_index_L] == 1, data$left_elixir_cost+costs[i],data$left_elixir_cost)
data$right_elixir_cost <- ifelse(data[,col_index_R] == 1, data$right_elixir_cost+costs[i],data$right_elixir_cost)
# if (data[,col_index_L] == 1) {
#   data$left_elixir_cost <- data$left_elixir_cost+costs[i]
# }
# if (data[,col_index_R] == 1) {
#   data$right_elixir_cost <- data$right_elixir_cost+costs[i]
# }
print(data$left_elixir_cost)
}
calc_avg_elixir()
View(data)
calc_avg_elixir <- function() {
data$left_elixir_cost <- 0
data$right_elixir_cost <- 0
for (i in 1:74) {
card_name_L <- paste("^", all_cards[i], "_L", "$", sep = "")
card_name_R <- paste("^", all_cards[i], "_R", "$", sep = "")
col_index_L <- grep(card_name_L, colnames(data))[1]
col_index_R <- grep(card_name_R, colnames(data))[1]
print(c(card_name_L,col_index_L))
data$left_elixir_cost <- ifelse(data[,col_index_L] == 1, data$left_elixir_cost+costs[i],data$left_elixir_cost)
data$right_elixir_cost <- ifelse(data[,col_index_R] == 1, data$right_elixir_cost+costs[i],data$right_elixir_cost)
# if (data[,col_index_L] == 1) {
#   data$left_elixir_cost <- data$left_elixir_cost+costs[i]
# }
# if (data[,col_index_R] == 1) {
#   data$right_elixir_cost <- data$right_elixir_cost+costs[i]
# }
print(data$left_elixir_cost[1])
}
calc_avg_elixir()
View(data)
data$left_elixir_cost <- 0
data$right_elixir_cost <- 0
calc_avg_elixir <- function() {
for (i in 1:74) {
card_name_L <- paste("^", all_cards[i], "_L", "$", sep = "")
card_name_R <- paste("^", all_cards[i], "_R", "$", sep = "")
col_index_L <- grep(card_name_L, colnames(data))[1]
col_index_R <- grep(card_name_R, colnames(data))[1]
print(c(card_name_L,col_index_L))
data$left_elixir_cost <- ifelse(data[,col_index_L] == 1, data$left_elixir_cost+costs[i],data$left_elixir_cost)
data$right_elixir_cost <- ifelse(data[,col_index_R] == 1, data$right_elixir_cost+costs[i],data$right_elixir_cost)
print(data$left_elixir_cost[1])
}
calc_avg_elixir()
summary(data$left_elixir_cost)
calc_avg_elixir <- function() {
for (i in 1:74) {
card_name_L <- paste("^", all_cards[i], "_L", "$", sep = "")
card_name_R <- paste("^", all_cards[i], "_R", "$", sep = "")
col_index_L <- grep(card_name_L, colnames(data))[1]
col_index_R <- grep(card_name_R, colnames(data))[1]
print(c(card_name_L,col_index_L))
data$left_elixir_cost <- ifelse(data[,col_index_L] == 1, data$left_elixir_cost+costs[i],data$left_elixir_cost)
data$right_elixir_cost <- ifelse(data[,col_index_R] == 1, data$right_elixir_cost+costs[i],data$right_elixir_cost)
print(data$left_elixir_cost[2])
}
calc_avg_elixir()
calc_avg_elixir <- function(df) {
for (i in 1:74) {
card_name_L <- paste("^", all_cards[i], "_L", "$", sep = "")
card_name_R <- paste("^", all_cards[i], "_R", "$", sep = "")
col_index_L <- grep(card_name_L, colnames(df))[1]
col_index_R <- grep(card_name_R, colnames(df))[1]
print(c(card_name_L,col_index_L))
df$left_elixir_cost <- ifelse(df[,col_index_L] == 1, df$left_elixir_cost+costs[i],df$left_elixir_cost)
df$right_elixir_cost <- ifelse(df[,col_index_R] == 1, df$right_elixir_cost+costs[i],df$right_elixir_cost)
print(df$left_elixir_cost[2])
}
data$left_elixir_cost <- 0
data$right_elixir_cost <- 0
calc_avg_elixir <- function(df) {
for (i in 1:74) {
card_name_L <- paste("^", all_cards[i], "_L", "$", sep = "")
card_name_R <- paste("^", all_cards[i], "_R", "$", sep = "")
col_index_L <- grep(card_name_L, colnames(df))[1]
col_index_R <- grep(card_name_R, colnames(df))[1]
print(c(card_name_L,col_index_L))
df$left_elixir_cost <- ifelse(df[,col_index_L] == 1, df$left_elixir_cost+costs[i],df$left_elixir_cost)
df$right_elixir_cost <- ifelse(df[,col_index_R] == 1, df$right_elixir_cost+costs[i],df$right_elixir_cost)
print(df$left_elixir_cost[2])
}
calc_avg_elixir(data)
summary(data$left_elixir_cost)
calc_avg_elixir <- function(df) {
for (i in 1:74) {
card_name_L <- paste("^", all_cards[i], "_L", "$", sep = "")
card_name_R <- paste("^", all_cards[i], "_R", "$", sep = "")
col_index_L <- grep(card_name_L, colnames(df))[1]
col_index_R <- grep(card_name_R, colnames(df))[1]
print(c(card_name_L,col_index_L))
df$left_elixir_cost <- ifelse(df[,col_index_L] == 1, df$left_elixir_cost+costs[i],df$left_elixir_cost)
df$right_elixir_cost <- ifelse(df[,col_index_R] == 1, df$right_elixir_cost+costs[i],df$right_elixir_cost)
print(df$left_elixir_cost[2])
}
return(df)
}
data <- calc_avg_elixir(data)
summary(data$left_elixir_cost)
data <- data %>%
subset(-X, -X.1)
data <- data %>%
select(-X, -X.1)
View(data)
write.csv(data, file = "processed_data.csv")
getw()
getwd()
rm(right_big_upsets, right_upsets)
rm(rw,x,spongbob,lw,left_upsets,left_big_upsets,data2,y2)
rm(rw,x,spongebob,lw,left_upsets,left_big_upsets,data2,y2)
# Barplot of Winrates
p_winrate <- ggplot(data=winrates, aes(x = reorder(Card, -Winrate), y = Use_rate, fill = reorder(Card, -Winrate))) +
geom_bar(stat = "identity") +
theme(axis.text.x = element_text(angle = 90, hjust = 1), plot.title = element_text(size = 24, face = "bold", hjust = 0.5)) +
ggtitle("Userate by Card") +
labs(fill = "Card Name") +
xlab("Card Name") +
coord_cartesian(ylim = c(0,0.46))
library(ggplot2)
# Barplot of Userate, ordered in the same way as winrate
p_userate2 <- ggplot(data = winrates, aes(x = reorder(Card, -Winrate), y = Use_rate, fill = reorder(Card, -Winrate))) +
geom_bar(stat = "identity") +
theme(axis.text.x = element_text(angle = 90, hjust = 1), plot.title = element_text(size = 24, face = "bold", hjust = 0.5)) +
ggtitle("Userate by Card") +
labs(fill = "Card Name") +
xlab("Card Name") +
coord_cartesian(ylim = c(0,0.46))
addSmallLegend(p_userate2, pointSize = 5, textSize = 11, spaceLegend = 1)
